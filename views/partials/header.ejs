<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <title>NitrusLeaf</title>
</head>
<body>
<%
    const flashSource = typeof getFlashMessages === 'function'
        ? getFlashMessages()
        : (typeof messages !== 'undefined' && messages ? messages : {});
    const flashTypes = [
        { key: 'success', className: 'flash-message success' },
        { key: 'danger', className: 'flash-message danger' },
        { key: 'error', className: 'flash-message error' },
        { key: 'warning', className: 'flash-message warning' },
        { key: 'info', className: 'flash-message info' }
    ];
    const hasFlash = flashSource && Object.keys(flashSource).length > 0;
%>
<% if (hasFlash) { %>
    <div class="flash-container">
        <% flashTypes.forEach(({ key, className }) => {
            const rawMessages = flashSource[key];
            if (!rawMessages) { return; }
            const normalized = Array.isArray(rawMessages) ? rawMessages : [rawMessages];
            normalized.forEach((msg) => { %>
                <div class="<%= className %>">
                    <span><%= msg %></span>
                    <button type="button" class="flash-close" onclick="this.parentElement.remove()">Ã—</button>
                </div>
        <% });
        }); %>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            document.querySelectorAll('.flash-message').forEach((element) => {
                setTimeout(() => {
                    if (element && element.parentElement) {
                        element.remove();
                    }
                }, 5000);
            });
        });
    </script>
<% } %>
